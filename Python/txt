Python version of the code
